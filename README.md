# Prevalents

The "Prevalent.cpp" file includes RCPP functions that need to be loaded into the R session. Documentation within the file provides explanations of the different functions as well as of their required arguments.

The file "Estimation Procedure.R" is an R file that contains the pairwise pseudolikelihood point-estimation, as well as the three bootstrap procedures for variance estimation, which can be used with a given data. The procedure requires that the data variables be named in a certain way, as described in the beginning of the code. Also, the data should be randomly ordered.

The file "Simulations - Data Generation and Estimation.R" contains the data generation process for the simulations detailed in the paper, along with the implementation of the estimation procedure on these data. o replicate Tables 2-4, adjust the relevant sections of the code for settings A, B, or C by commenting or uncommenting as indicated in the comments within the code. After making these adjustments, run the estimation procedure to obtain the results.

The real-data analysis utilizes UK Biobank (UKB) data, which are not publicly available. We provide a smaller mock dataset generated by the R package `synthpop`, comprising approximately 150,000 observations instead of 500,000. This mock dataset serves primarily to illustrate the estimation procedure used with the UKB data. The file `UKB Analysis.R` contains the code for executing the estimation procedure across all 24 SNPs and aggregating the results into adjusted p-values. 

UKB Data Preprocessing: SNPs and genetic principal components are centered and scaled to have a mean of zero and a variance of one, as indicated in the code. We have recoded all SNPs so that the effect allele—associated with an increased risk of bladder cancer—is the allele counted. This recoding may differ from the default in the UKB data. The mock dataset reflects this recoding, which can be easily implemented by using the transformation x -> 2 - x. The SNPs that were recoded include rs11892031, rs10936599, rs710521, rs798766, rs401681, rs4813953, and rs1058396.  

Note that the "Prevalents" file contains a function "getZetaTerms" which should be used if censoring is assumed fixed and not random. When censoring is fixed, one should also comment out the parts in the code that estimate the censoring distribution. The function "getZetaTermsC" should alternatively be used when censoring should also be estimated.

In the model for death-after-disease (transition 2->3), the disease age can be used as covariate, which is how the estimation procedure is currently written. One could in theory choose to insert other functional forms of the disease age, however this option is not yet implemented.


